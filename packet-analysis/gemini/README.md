# Gemini Traffic Classification Analysis

This directory contains all analysis files for classifying Gemini vs non-LLM network flowlets.

## Directory Contents

### Python Scripts
- **`flowlet_models_gemini.py`** - Train classification models (Random Forest, SVM, XGBoost) for Gemini detection
- **`flowlet_analysis_gemini.py`** - Analyze feature importance, correlations, and distributions for Gemini

### Results & Reports
- **`model_results_gemini.json`** - Detailed classification metrics for all three models
- **`FEATURE_ANALYSIS_SUMMARY.md`** - Comprehensive feature analysis findings
- **`GEMINI_ANALYSIS_SUMMARY.md`** - Detailed comparison with ChatGPT analysis
- **`analysis_results_gemini.json`** - Feature analysis results (correlations, importance, statistical tests)

### Visualizations (`analysis_plots_gemini/`)
- **`correlation_heatmap.png`** - Feature correlation matrix heatmap
- **`feature_importance.png`** - Feature importance comparison (RF vs XGBoost)
- **`feature_distributions.png`** - Distribution comparisons (Gemini vs non-LLM)
- **`target_correlations.png`** - Feature correlations with Gemini label

## Quick Start

### 1. Train Gemini Classification Models
```bash
python flowlet_models_gemini.py ../../flowlet_features.json --output model_results_gemini.json
```

### 2. Analyze Gemini Features
```bash
python flowlet_analysis_gemini.py ../../flowlet_features.json --output analysis_results_gemini.json --output-dir analysis_plots_gemini
```

## Key Findings

### Model Performance (Gemini vs Non-LLM)

| Model | Accuracy | Precision | Recall | F1 Score |
|-------|----------|-----------|--------|----------|
| **Random Forest** | **96.24%** | **86.58%** | 33.83% | 48.65% |
| SVM | 95.98% | 80.84% | 31.09% | 44.91% |
| **XGBoost** | **96.14%** | **86.64%** | 31.59% | 46.29% |

### Gemini vs ChatGPT Comparison

| Metric | Gemini | ChatGPT | Winner |
|--------|--------|---------|--------|
| Accuracy | 96.24% | 95.04% | ✅ Gemini (+1.2%) |
| Precision | 86.58% | 98.03% | ❌ ChatGPT (+11.5%) |
| Recall | 33.83% | 59.23% | ❌ ChatGPT (+25.4%) |
| F1 Score | 48.65% | 73.85% | ❌ ChatGPT (+25.2%) |

**Key Insight**: Gemini is **much harder to detect** than ChatGPT (34% vs 59% recall).

### Feature Importance

**Top Features for Gemini Detection:**
1. **Duration** (91.2% importance in XGBoost) - Gemini sessions have distinctive timing
2. **Packet size variability** - More variable than ChatGPT
3. **Inter-packet timing** - Different streaming patterns

**Gemini vs ChatGPT Signatures:**
- **ChatGPT**: Size-based (large packets, high total bytes)
- **Gemini**: Timing-based (duration, variability patterns)

## Dataset

- **Total flowlets**: 75,202 (Gemini + non-LLM)
- **Gemini flowlets**: 3,064 (4.1%) - 42% fewer than ChatGPT
- **Non-LLM flowlets**: 72,138 (95.9%)
- **Train/Test split**: 80/20 by flow groups

## Why Gemini is Harder to Detect

1. **Different architecture** - Gemini uses different streaming patterns than ChatGPT
2. **Weaker signature** - Multiple medium-effect features vs ChatGPT's strong packet-size signal
3. **Less training data** - 3,064 vs 5,299 flowlets for ChatGPT
4. **More distributed features** - No single dominant feature like ChatGPT's packet_size_mean

## Recommendations

### For Improving Gemini Detection
1. **Collect more Gemini data** - Current dataset is 42% smaller than ChatGPT
2. **Focus on timing features** - Duration and timing variability are key
3. **Feature engineering**:
   - Add burst pattern detection
   - Session-level timing aggregations
   - Sequence-based temporal features

### For Multi-LLM Systems
Since ChatGPT and Gemini have fundamentally different signatures:
- Use **provider-specific models** rather than one-size-fits-all
- Consider **hierarchical classification**: LLM vs non-LLM → Provider classification
- Combine **size-based** (ChatGPT) and **timing-based** (Gemini) features

## Dependencies

Same as main packet-analysis directory:
```bash
pip install numpy scikit-learn xgboost matplotlib seaborn scipy
```

## Files Structure

```
gemini/
├── flowlet_models_gemini.py          # Model training script
├── flowlet_analysis_gemini.py        # Feature analysis script
├── model_results_gemini.json         # Model performance metrics
├── analysis_results_gemini.json      # Feature analysis results
├── FEATURE_ANALYSIS_SUMMARY.md       # Feature analysis summary
├── GEMINI_ANALYSIS_SUMMARY.md        # Detailed comparison analysis
├── README.md                         # This file
└── analysis_plots_gemini/            # Visualization plots
    ├── correlation_heatmap.png
    ├── feature_importance.png
    ├── feature_distributions.png
    └── target_correlations.png
```

## Related Files

- Input data: `../../flowlet_features.json` (generated by `../parse_flowlets.py`)
- Capture files: `../../captures/gemini_ipv4/` and `../../captures/gemini_ipv6/`
- Comparison: `../chatgpt/` (ChatGPT analysis for comparison)